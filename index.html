<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Infinity Craft - Ù…ÙˆØ¯Ø§Øª Ù…Ø§ÙŠÙ†ÙƒØ±Ø§ÙØª</title>
<style>
  body { font-family: 'Cairo', sans-serif; background: #fff; color: #222; text-align: center; }
  header { background: red; color: #fff; padding: 15px; font-size: 24px; font-weight: bold; }
  .mod { border: 2px solid #ccc; border-radius: 15px; padding: 15px; margin: 10px auto; width: 90%; max-width: 500px; background: #f9f9f9; }
  .mod img { width: 100%; border-radius: 10px; }
  button { background: green; color: white; border: none; padding: 10px; border-radius: 10px; cursor: pointer; margin: 5px; }
  .delete { background: crimson; }
  .info { font-size: 14px; color: #666; }
</style>
</head>
<body>

<header>Infinity Craft - Ù…ÙˆØ¯Ø§Øª Ù…Ø§ÙŠÙ†ÙƒØ±Ø§ÙØª</header>
<p>Ø§Ù„Ù…Ø·ÙˆØ±: Asernoby23 | Ø§Ù„Ù…Ø§Ù„Ùƒ: kraivx09</p>

<h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
<input type="email" id="email" placeholder="Ø§Ù„Ø§ÙŠÙ…ÙŠÙ„"><br>
<input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±"><br>
<button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
<button onclick="signup()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
<hr>

<h3>Ù†Ø´Ø± Ù…ÙˆØ¯ Ø¬Ø¯ÙŠØ¯</h3>
<input type="text" id="modName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¯"><br>
<input type="text" id="modImage" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©"><br>
<input type="text" id="modLink" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„"><br>
<button onclick="addMod()">Ù†Ø´Ø± Ø§Ù„Ù…ÙˆØ¯</button>

<h2>ğŸ“¦ Ø§Ù„Ù…ÙˆØ¯Ø§Øª Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©</h2>
<div id="mods"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAtn8wwDmlWe95RA13kAQiY0XDkhnuKoQ0",
    authDomain: "infinity-craft-301e4.firebaseapp.com",
    databaseURL: "https://infinity-craft-301e4-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "infinity-craft-301e4",
    storageBucket: "infinity-craft-301e4.firebasestorage.app",
    messagingSenderId: "979672021905",
    appId: "1:979672021905:web:849ecc0ed6379edb2eb830",
    measurementId: "G-G188MXB3JY"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const auth = getAuth(app);
  const modsRef = ref(db, "mods");

  // ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
  window.signup = function() {
    const email = document.getElementById("email").value;
    const pass = document.getElementById("password").value;
    createUserWithEmailAndPassword(auth, email, pass)
      .then((userCredential) => {
        alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­");
        updateMods(userCredential.user); // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Øª Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨
      })
      .catch(e => alert("Ø®Ø·Ø£: " + e.message));
  }

  // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  window.login = function() {
    const email = document.getElementById("email").value;
    const pass = document.getElementById("password").value;
    signInWithEmailAndPassword(auth, email, pass)
      .then((userCredential) => {
        alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„");
        updateMods(userCredential.user); // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Øª Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
      })
      .catch(e => alert("Ø®Ø·Ø£: " + e.message));
  }

  // Ù†Ø´Ø± Ù…ÙˆØ¯
  window.addMod = function() {
    const user = auth.currentUser;
    if (!user) { alert("Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹!"); return; }

    const name = document.getElementById("modName").value;
    const image = document.getElementById("modImage").value;
    const link = document.getElementById("modLink").value;

    push(ref(db, "mods"), {
      name: name,
      image: image,
      link: link,
      owner: user.uid
    });

    alert("âœ… ØªÙ… Ù†Ø´Ø± Ø§Ù„Ù…ÙˆØ¯!");
  }

  // Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¯
  window.deleteMod = function(id) {
    const user = auth.currentUser;
    if (!user) { alert("Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹!"); return; }

    const modRef = ref(db, "mods/" + id);
    remove(modRef)
      .then(() => alert("ğŸ—‘ ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­"))
      .catch(e => alert("âŒ ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: " + e.message));
  }

  // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Øª Ø¨Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
  function updateMods(user) {
    onValue(modsRef, (snapshot) => {
      const data = snapshot.val();
      const container = document.getElementById("mods");
      container.innerHTML = "";
      for (let id in data) {
        const mod = data[id];
        const div = document.createElement("div");
        div.className = "mod";
        div.innerHTML = `
          <h3>${mod.name}</h3>
          <img src="${mod.image}" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…ÙˆØ¯">
          <p><a href="${mod.link}" target="_blank">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¯</a></p>
          ${user && user.uid === mod.owner ? `<button class="delete" onclick="deleteMod('${id}')">ğŸ—‘ Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¯</button>` : ""}
        `;
        container.appendChild(div);
      }
    });
  }

  // Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
  onAuthStateChanged(auth, (user) => {
    updateMods(user); // Ø¯Ø§ÙŠÙ…Ù‹Ø§ ÙŠØ­Ø¯Ø« Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Øª Ø¹Ù„Ù‰ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    if (user) {
      console.log("Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„:", user.email);
    } else {
      console.log("Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„");
    }
  });
</script>

</body>
</html>
